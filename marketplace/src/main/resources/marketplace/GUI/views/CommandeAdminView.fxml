<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.shape.SVGPath?>

<VBox spacing="20" style="-fx-background-color: #fefbde;" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="marketplace.GUI.Controller.CommandeAdminController">
   <padding>
      <Insets bottom="20" left="20" right="20" top="20" />
   </padding>
   
   <!-- Header -->
   <HBox alignment="CENTER_LEFT" spacing="15">
      <children>
         <SVGPath content="M18 6h-2c0-2.21-1.79-4-4-4S8 3.79 8 6H6c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm-6-2c1.1 0 2 .9 2 2h-4c0-1.1.9-2 2-2zm6 16H6V8h2v2c0 .55.45 1 1 1s1-.45 1-1V8h4v2c0 .55.45 1 1 1s1-.45 1-1V8h2v12z" fill="#8e44ad" scaleX="1.5" scaleY="1.5" />
         <Label style="-fx-font-size: 28px; -fx-font-weight: bold; -fx-text-fill: #333;" text="Gestion des Commandes" />
      </children>
   </HBox>
   
   <!-- Filters Row -->
   <HBox alignment="CENTER_LEFT" spacing="15">
      <children>
         <!-- Search -->
         <TextField fx:id="searchField" prefWidth="250" promptText="Rechercher par numéro ou client..." style="-fx-background-radius: 5;" />
         
         <!-- Payment Status Filter -->
         <ComboBox fx:id="paymentFilterCombo" prefWidth="150" promptText="Paiement" style="-fx-background-radius: 5;" />
         
         <!-- Delivery Status Filter -->
         <ComboBox fx:id="deliveryFilterCombo" prefWidth="150" promptText="Livraison" style="-fx-background-radius: 5;" />
         
         <!-- Refresh Button -->
         <Button onAction="#handleRefresh" style="-fx-background-color: #3498db; -fx-text-fill: white; -fx-background-radius: 5; -fx-cursor: hand;" text="Actualiser">
            <graphic>
               <SVGPath content="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z" fill="white" scaleX="0.8" scaleY="0.8" />
            </graphic>
         </Button>
         
         <HBox HBox.hgrow="ALWAYS" />
         
         <!-- Stats Labels -->
         <Label fx:id="totalCountLabel" style="-fx-font-size: 14px; -fx-text-fill: #666;" text="Total: 0" />
         <Label fx:id="paidCountLabel" style="-fx-font-size: 14px; -fx-text-fill: #27ae60; -fx-font-weight: bold;" text="Payées: 0" />
         <Label fx:id="pendingCountLabel" style="-fx-font-size: 14px; -fx-text-fill: #f39c12; -fx-font-weight: bold;" text="En attente: 0" />
      </children>
   </HBox>
   
   <!-- Table -->
   <TableView fx:id="commandeTable" VBox.vgrow="ALWAYS" style="-fx-background-radius: 8;">
      <columns>
         <TableColumn fx:id="colId" prefWidth="50" text="ID" />
         <TableColumn fx:id="colNumero" prefWidth="140" text="N° Commande" />
         <TableColumn fx:id="colClient" prefWidth="150" text="Client" />
         <TableColumn fx:id="colMontant" prefWidth="100" text="Montant" />
         <TableColumn fx:id="colPaiement" prefWidth="100" text="Paiement" />
         <TableColumn fx:id="colLivraison" prefWidth="120" text="Livraison" />
         <TableColumn fx:id="colAdresse" prefWidth="180" text="Adresse" />
         <TableColumn fx:id="colVille" prefWidth="100" text="Ville" />
         <TableColumn fx:id="colDate" prefWidth="140" text="Date Commande" />
         <TableColumn fx:id="colActions" prefWidth="150" text="Actions" />
      </columns>
   </TableView>
   
   <!-- Bottom Actions -->
   <HBox alignment="CENTER_RIGHT" spacing="10">
      <children>
         <Button onAction="#handleExport" style="-fx-background-color: #9b59b6; -fx-text-fill: white; -fx-background-radius: 5; -fx-cursor: hand;" text="Exporter CSV">
            <graphic>
               <SVGPath content="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z" fill="white" scaleX="0.8" scaleY="0.8" />
            </graphic>
         </Button>
      </children>
   </HBox>
</VBox>
